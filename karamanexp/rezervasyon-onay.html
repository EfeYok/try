<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karaman Express - Biletiniz Hazƒ±r!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes checkmark {
            0% { stroke-dashoffset: 100; }
            100% { stroke-dashoffset: 0; }
        }
        .checkmark-circle {
            animation: checkmark 0.6s ease-in-out;
            stroke-dasharray: 100;
            stroke-dashoffset: 0;
        }
        @media print {
            body { background: white !important; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-900 via-blue-600 to-blue-400">
    <!-- Header -->
    <div class="bg-white shadow-lg no-print">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                    <h1 class="text-2xl font-bold text-gray-800">Karaman Express</h1>
                </div>
                <div class="text-sm text-gray-600">
                    üìû 0555 555 55 55
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <!-- Ba≈üarƒ± Mesajƒ± -->
        <div class="max-w-4xl mx-auto mb-8 no-print">
            <div class="bg-white rounded-2xl shadow-2xl p-8 text-center">
                <div class="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-12 h-12 text-white checkmark-circle" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                    </svg>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">üéâ Rezervasyonunuz Tamamlandƒ±!</h2>
                <p class="text-gray-600 text-lg mb-4">
                    Biletiniz hazƒ±r. E-posta ve SMS ile g√∂nderildi.
                </p>
                <div class="inline-flex items-center gap-2 bg-blue-50 px-6 py-3 rounded-full">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <span class="text-blue-800 font-semibold">PNR Kodu: <span id="pnr-code" class="font-mono text-xl">-</span></span>
                </div>
            </div>
        </div>

        <!-- Bilet -->
        <div class="max-w-4xl mx-auto">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
                <!-- Bilet √úst Kƒ±sƒ±m (Mavi Gradyan) -->
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 p-6 text-white">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center gap-3">
                            <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            <div>
                                <div class="text-2xl font-bold">Karaman Express</div>
                                <div class="text-sm text-blue-100">Otob√ºs Bileti</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm text-blue-100">Bilet No</div>
                            <div class="text-xl font-mono font-bold" id="ticket-number">-</div>
                        </div>
                    </div>

                    <!-- G√ºzergah (B√ºy√ºk) -->
                    <div class="flex items-center justify-between bg-white/10 backdrop-blur-sm rounded-xl p-6">
                        <div class="text-center flex-1">
                            <div class="text-sm text-blue-100 mb-1">KALKI≈û</div>
                            <div class="text-3xl font-bold" id="ticket-from">-</div>
                            <div class="text-xl font-bold text-blue-200 mt-2" id="ticket-time">-</div>
                        </div>
                        <div class="flex-1 flex flex-col items-center px-4">
                            <svg class="w-16 h-16 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                            <div class="text-sm text-blue-200" id="ticket-duration">-</div>
                        </div>
                        <div class="text-center flex-1">
                            <div class="text-sm text-blue-100 mb-1">VARI≈û</div>
                            <div class="text-3xl font-bold" id="ticket-to">-</div>
                            <div class="text-sm text-blue-200 mt-2" id="ticket-distance">-</div>
                        </div>
                    </div>
                </div>

                <!-- Kesikli √áizgi -->
                <div class="relative h-8 bg-gradient-to-r from-blue-600 to-blue-700">
                    <div class="absolute inset-0 flex items-center justify-between px-4">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-900 via-blue-600 to-blue-400 rounded-full"></div>
                        <div class="flex-1 border-t-4 border-dashed border-white/30 mx-2"></div>
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-900 via-blue-600 to-blue-400 rounded-full"></div>
                    </div>
                </div>

                <!-- Bilet Alt Kƒ±sƒ±m (Detaylar) -->
                <div class="p-6">
                    <!-- Yolcu Bilgileri -->
                    <div class="mb-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-3 border-b pb-2">Yolcu Bilgileri</h3>
                        <div id="passengers-list" class="space-y-3">
                            <p class="text-gray-500">Y√ºkleniyor...</p>
                        </div>
                    </div>

                    <!-- Sefer Detaylarƒ± -->
                    <div class="grid md:grid-cols-3 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                        <div>
                            <div class="text-xs text-gray-500 mb-1">TARƒ∞H</div>
                            <div class="text-sm font-bold text-gray-800" id="ticket-date">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 mb-1">KOLTUK NO</div>
                            <div class="text-2xl font-bold text-blue-600" id="seat-number">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 mb-1">OTOB√úS Tƒ∞Pƒ∞</div>
                            <div class="text-sm font-bold text-gray-800" id="bus-type">-</div>
                        </div>
                    </div>

                    <!-- ƒ∞leti≈üim Bilgileri -->
                    <div class="grid md:grid-cols-2 gap-4 mb-6 p-4 bg-blue-50 rounded-lg">
                        <div>
                            <div class="text-xs text-gray-500 mb-1">TELEFON</div>
                            <div class="text-sm font-semibold text-gray-800" id="passenger-phone">-</div>
                        </div>
                        <div>
                            <div class="text-xs text-gray-500 mb-1">E-POSTA</div>
                            <div class="text-sm font-semibold text-gray-800 truncate" id="passenger-email">-</div>
                        </div>
                    </div>

                    <!-- Fiyat ve QR -->
                    <div class="flex items-center justify-between pt-6 border-t-2 border-gray-200">
                        <div>
                            <div class="text-sm text-gray-500 mb-1">TOPLAM √úCRET</div>
                            <div class="text-4xl font-bold text-green-600" id="total-amount">0 ‚Ç∫</div>
                        </div>
                        <div class="text-center">
                            <div class="w-32 h-32 bg-gray-200 rounded-lg flex items-center justify-center">
                                <svg class="w-28 h-28 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zm8-2v8h8V3h-8zm6 6h-4V5h4v4zM3 21h8v-8H3v8zm2-6h4v4H5v-4zm13-2h-2v2h2v-2zm-2 2h-2v2h2v-2zm2 2h-2v2h2v-2zm0 2h-2v2h2v-2zm2-6h2v2h-2v-2zm0 2h2v2h-2v-2zm0 2h2v2h-2v-2z"/>
                                </svg>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">QR Kod</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aksiyonlar -->
            <div class="flex flex-wrap gap-4 justify-center mt-8 no-print">
                <button onclick="window.print()" class="bg-white hover:bg-gray-100 text-gray-800 px-6 py-3 rounded-lg font-bold transition-all shadow-lg flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                    </svg>
                    Yazdƒ±r / PDF Kaydet
                </button>
                <button onclick="newBooking()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-bold transition-all shadow-lg flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    Yeni Bilet Al
                </button>
            </div>

            <!-- √ñnemli Bilgiler -->
            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-6 mt-8 no-print">
                <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <svg class="w-6 h-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    √ñnemli Bilgiler
                </h3>
                <div class="grid md:grid-cols-2 gap-4 text-white">
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">L√ºtfen seferden en az 30 dakika √∂nce terminalde olunuz.</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">Seyahat sƒ±rasƒ±nda kimlik ibraz etmeniz gerekmektedir.</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">ƒ∞ptal ve deƒüi≈üiklik i≈ülemleri i√ßin seferden 2 saat √∂nce ileti≈üime ge√ßiniz.</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">Bagaj haklarƒ±: 30 kg (Standart), 40 kg (VIP)</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">Biletiniz e-posta ve SMS ile g√∂nderilmi≈ütir.</span>
                    </div>
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                        <span class="text-sm">M√º≈üteri Hizmetleri: 0850 123 45 67</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="bg-blue-900/50 backdrop-blur-sm mt-12 py-6 no-print">
        <div class="container mx-auto px-4 text-center text-white">
            <p class="mb-1">¬© 2025 Karaman Express - T√ºm haklarƒ± saklƒ±dƒ±r.</p>
            <p class="text-sm text-blue-200">ƒ∞yi yolculuklar dileriz! üöå</p>
        </div>
    </div>

    <script>
        console.log('üöÄ Onay sayfasƒ± ba≈ülatƒ±lƒ±yor...');
        
        // LocalStorage'dan verileri al
        const tripData = JSON.parse(localStorage.getItem('selectedTrip'));
        const seatData = JSON.parse(localStorage.getItem('selectedSeatData'));
        const passengerInfo = JSON.parse(localStorage.getItem('passengerInfo'));

        console.log('üì¶ LocalStorage Verileri:');
        console.log('tripData:', tripData);
        console.log('seatData:', seatData);
        console.log('passengerInfo:', passengerInfo);

        // Veri kontrol√º
        if (!tripData || !seatData || !passengerInfo) {
            console.error('‚ùå Eksik veri tespit edildi!');
            alert('‚ö†Ô∏è Rezervasyon bilgileri bulunamadƒ±. Ana sayfaya y√∂nlendiriliyorsunuz.');
            window.location.href = 'index.html';
        }

        // PNR ve Bilet Numarasƒ±
        const pnrCode = (passengerInfo && passengerInfo.pnr) || ('KE' + Math.floor(Math.random() * 1000000).toString().padStart(6, '0'));
        const ticketNumber = 'BLT' + Date.now().toString().slice(-8);

        document.getElementById('pnr-code').textContent = pnrCode;
        document.getElementById('ticket-number').textContent = ticketNumber;

        console.log('üé´ PNR:', pnrCode);
        console.log('üé´ Bilet No:', ticketNumber);

        // Sefer Bilgileri
        document.getElementById('ticket-from').textContent = tripData.from || '-';
        document.getElementById('ticket-to').textContent = tripData.to || '-';
        document.getElementById('ticket-time').textContent = tripData.time || '-';
        document.getElementById('ticket-duration').textContent = tripData.duration || '-';
        document.getElementById('ticket-distance').textContent = tripData.distance || '-';
        document.getElementById('ticket-date').textContent = (tripData.date && tripData.date.formatted) || '-';
        document.getElementById('bus-type').textContent = tripData.busType || '-';

        console.log('‚úÖ Sefer bilgileri y√ºklendi');

        // Yolcu Listesi
        const passengersList = document.getElementById('passengers-list');
        passengersList.innerHTML = ''; // Temizle

        if (passengerInfo.passengers && Array.isArray(passengerInfo.passengers) && passengerInfo.passengers.length > 0) {
            console.log('üë• Yolcu Sayƒ±sƒ±:', passengerInfo.passengers.length);
            
            passengerInfo.passengers.forEach((passenger, index) => {
                console.log(`üë§ Yolcu ${index + 1}:`, passenger);
                
                const passengerCard = document.createElement('div');
                passengerCard.className = 'bg-gray-50 p-4 rounded-lg';
                passengerCard.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-xs font-semibold text-gray-500">YOLCU ${index + 1}</span>
                        <span class="text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded-full font-bold">Koltuk ${passenger.seatNumber || '-'}</span>
                    </div>
                    <div class="text-lg font-bold text-gray-900 mb-1">${(passenger.fullname || 'Bilinmiyor').toUpperCase()}</div>
                    <div class="flex gap-4 text-sm text-gray-600">
                        <span>TC: <strong>${passenger.tcno || '-'}</strong></span>
                        <span>${passenger.gender === 'Erkek' ? 'üë®' : passenger.gender === 'Kadƒ±n' ? 'üë©' : 'üë§'} ${passenger.gender || '-'}</span>
                    </div>
                `;
                passengersList.appendChild(passengerCard);
            });
            
            console.log('‚úÖ Yolcu listesi olu≈üturuldu');
        } else {
            console.warn('‚ö†Ô∏è Yolcu listesi bulunamadƒ±, tek yolcu formatƒ± deneniyor...');
            
            // Fallback - tek yolcu
            const passengerCard = document.createElement('div');
            passengerCard.className = 'bg-gray-50 p-4 rounded-lg';
            passengerCard.innerHTML = `
                <div class="text-xs font-semibold text-gray-500 mb-2">YOLCU Bƒ∞LGƒ∞Sƒ∞</div>
                <div class="text-lg font-bold text-gray-900 mb-1">${(passengerInfo.fullname || 'Bilinmiyor').toUpperCase()}</div>
                <div class="flex gap-4 text-sm text-gray-600">
                    <span>TC: <strong>${passengerInfo.tcno || '-'}</strong></span>
                    <span>${passengerInfo.gender || '-'}</span>
                </div>
            `;
            passengersList.appendChild(passengerCard);
        }

        // ƒ∞leti≈üim Bilgileri
        document.getElementById('passenger-phone').textContent = passengerInfo.phone || '-';
        document.getElementById('passenger-email').textContent = passengerInfo.email || '-';

        console.log('‚úÖ ƒ∞leti≈üim bilgileri y√ºklendi');

        // Koltuk Numaralarƒ±
        let seatNumbers = '';
        if (seatData.seats && Array.isArray(seatData.seats) && seatData.seats.length > 0) {
            seatNumbers = seatData.seats.map(s => s.seatNumber).join(', ');
        } else if (seatData.seatNumber) {
            seatNumbers = seatData.seatNumber.toString();
        } else {
            seatNumbers = '-';
        }
        document.getElementById('seat-number').textContent = seatNumbers;

        console.log('ü™ë Koltuklar:', seatNumbers);

        // Toplam Fiyat
        const passengerCount = (seatData.seats && seatData.seats.length) || 1;
        const totalPrice = (tripData.price || 0) * passengerCount;
        document.getElementById('total-amount').textContent = totalPrice + ' ‚Ç∫';

        console.log('üí∞ Toplam Fiyat:', totalPrice + ' ‚Ç∫');
        console.log('‚úÖ T√ºm veriler y√ºklendi!');

        function newBooking() {
            localStorage.clear();
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>